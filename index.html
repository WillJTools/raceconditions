<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8" />
  <meta name="viewport" content="width=device-width,initial-scale=1.0" />
  <title>CANNON - Race Condition Evidence Generator</title>

  <!-- IMPORTANT: publish ONLY this file (obfuscated). Do NOT reference cannon.js -->
  <script src="cannon.obf.js" defer></script>

  <style>
    body { font-family: Arial, sans-serif; background:#0f1115; margin:0; padding:0; color:#e7e7e7; text-align:center; }
    .container { max-width: 1050px; margin:40px auto; background:#141824; padding:22px; border-radius:12px; box-shadow:0 0 18px rgba(0,0,0,.35); }
    h1 { color:#ff3b3b; margin:0 0 6px; letter-spacing:1px; }
    p { color:#b8c0cc; margin:0 0 18px; }
    .hint { font-size:12px; color:#97a3b3; max-width:920px; margin:0 auto 18px; line-height:1.45; }

    textarea {
      width:100%;
      height:190px;
      padding:12px;
      border:1px solid #2a3242;
      background:#0f1115;
      color:#e7e7e7;
      border-radius:10px;
      resize:vertical;
      font-size:13px;
      font-family: ui-monospace, SFMono-Regular, Menlo, Monaco, Consolas, "Liberation Mono", "Courier New", monospace;
    }

    .grid { display:grid; grid-template-columns: repeat(4, minmax(180px, 1fr)); gap:12px; margin-top:12px; }
    @media (max-width: 980px) { .grid { grid-template-columns: repeat(2, minmax(180px, 1fr)); } }
    @media (max-width: 560px) { .grid { grid-template-columns: 1fr; } }

    .field { text-align:left; background:#0f1115; border:1px solid #2a3242; border-radius:10px; padding:10px; }
    label { display:block; font-size:12px; color:#b8c0cc; margin-bottom:6px; }
    input, select {
      width:100%;
      padding:10px;
      border:1px solid #2a3242;
      background:#141824;
      color:#e7e7e7;
      border-radius:8px;
      font-size:14px;
      outline:none;
    }
    .full { grid-column: 1 / -1; }

    .buttons { display:flex; justify-content:center; gap:10px; flex-wrap:wrap; margin-top:14px; }
    button {
      padding:10px 18px;
      border:0;
      border-radius:10px;
      cursor:pointer;
      font-size:14px;
      font-weight:700;
    }
    #generateBtn { background:#ff3b3b; color:#0f1115; }
    #generateBtn:hover { background:#ff1f1f; }
    #copyBtn { background:#2bd576; color:#0f1115; }
    #copyBtn:hover { background:#21b861; }

    .sub { margin-top:16px; text-align:left; color:#b8c0cc; font-size:12px; line-height:1.55; }
    .sub code { color:#e7e7e7; }
    .warn { color:#ffb84d; }
  </style>
</head>
<body>
  <div class="container">
    <h1>CANNON</h1>
    <p>Generate race-condition evidence scripts from Burp raw HTTP or cURL</p>

    <div class="hint">
      Paste a raw HTTP request (Burp Repeater style) or a curl command. Cannon generates Python that fires
      synchronized concurrent requests (max 10) and produces <b>report-ready proof</b> with artifacts (JSONL/CSV).
      <span class="warn">Use only on systems you’re authorized to test.</span>
    </div>

    <h3 style="margin:0 0 10px;">Paste Request</h3>
    <textarea id="reqInput" placeholder="Paste raw HTTP request or curl here..."></textarea>

    <div class="grid">
      <div class="field">
        <label for="concurrency">Concurrency (1–10)</label>
        <input id="concurrency" type="number" min="1" max="10" value="5" />
      </div>

      <div class="field">
        <label for="rounds">Rounds (bursts)</label>
        <input id="rounds" type="number" min="1" max="200" value="10" />
      </div>

      <div class="field">
        <label for="timeout">Timeout (sec)</label>
        <input id="timeout" type="number" min="1" max="120" value="15" />
      </div>

      <div class="field">
        <label for="scheme">Default scheme (raw HTTP)</label>
        <select id="scheme">
          <option value="https" selected>https</option>
          <option value="http">http</option>
        </select>
      </div>

      <div class="field full">
        <label for="successType">Success check type</label>
        <select id="successType">
          <option value="json" selected>JSON Path Equals (recommended)</option>
          <option value="match">Match String</option>
          <option value="none">None (not recommended)</option>
        </select>
      </div>

      <div class="field full" id="matchFieldWrap">
        <label for="matchString">Match string (SUCCESS if response contains this substring)</label>
        <input id="matchString" type="text" placeholder='e.g., "success\":true" or "redeemed\":true' />
      </div>

      <div class="field full" id="jsonPathWrap">
        <label for="jsonPath">JSON path (comma-separated) — SUCCESS if value matches</label>
        <input id="jsonPath" type="text" placeholder='e.g., data,redeem,success' value="data,redeem,success" />
      </div>

      <div class="field full" id="jsonValueWrap">
        <label for="jsonValue">JSON expected value (true/false/number/string)</label>
        <input id="jsonValue" type="text" placeholder='e.g., true' value="true" />
      </div>

      <div class="field full">
        <label for="targetKeys">Target keys (comma-separated) used to prove “same object” multi-success</label>
        <input id="targetKeys" type="text" placeholder='e.g., coupon_id,order_id,redeemId,transactionId' value="coupon_id,order_id,redeemId,transactionId" />
      </div>

      <div class="field full">
        <label for="maxSnippet">Response snippet chars (evidence excerpt)</label>
        <input id="maxSnippet" type="number" min="50" max="5000" value="800" />
      </div>
    </div>

    <div class="buttons">
      <button id="generateBtn">GENERATE EVIDENCE SCRIPT</button>
      <button id="copyBtn">COPY CODE</button>
    </div>

    <h3 style="margin:18px 0 10px;">Generated Python (Evidence Mode)</h3>
    <textarea id="pyOutput" readonly placeholder="Generated script will appear here..."></textarea>

    <div class="sub">
      <div><b>Publish model:</b> Commit <code>index.html</code> + <code>cannon.obf.js</code> only.</div>
      <div><b>Local model:</b> Keep <code>cannon.js</code> private and obfuscate it into <code>cannon.obf.js</code>.</div>
      <div><b>Tip:</b> For “clear cut” findings, use <code>JSON Path Equals</code> and include <code>targetKeys</code> that identify the raced resource.</div>
    </div>
  </div>
</body>
</html>
